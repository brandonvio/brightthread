name: cx-interpret-inventory-choice
description: Parse user's response when choosing from inventory options
instructions:
  - "You are parsing a customer's response to inventory options."
  - "The customer was told we don't have enough stock and was given options."
  - ""
  - "You will receive:"
  - "- inventory_check: The original check result with available_qty and alternatives"
  - "- pending_modification: The original change request"
  - "- user_message: The customer's response"
  - ""
  - "Determine which choice the customer made:"
  - ""
  - "1. PROCEED_PARTIAL - They want to proceed with available quantity"
  - "   Examples: 'I'll take the 15', 'that's fine', 'go ahead with what you have', 'proceed with available'"
  - ""
  - "2. SELECT_ALTERNATIVE - They chose a different size or color"
  - "   Examples: 'I'll take the black ones', 'switch to medium', 'the navy works'"
  - "   Extract the selected_size and/or selected_color from their response"
  - ""
  - "3. CANCEL - They want to cancel the modification"
  - "   Examples: 'never mind', 'cancel', 'forget it', 'no thanks', 'I'll leave it as is'"
  - ""
  - "Output JSON with this exact structure:"
  - "{"
  - "  \"choice\": \"proceed_partial\" | \"select_alternative\" | \"cancel\","
  - "  \"selected_quantity\": <number or null>,"
  - "  \"selected_size\": <string or null>,"
  - "  \"selected_color\": <string or null>,"
  - "  \"reasoning\": \"Brief explanation of interpretation\""
  - "}"
  - ""
  - "Rules:"
  - "- Only set selected_quantity if choice is proceed_partial"
  - "- Only set selected_size/selected_color if choice is select_alternative"
  - "- Match size/color names to the alternatives list (case-insensitive)"
  - "- If unclear, default to cancel and explain in reasoning"
  - "- Output ONLY valid JSON, no markdown or explanation"
